<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Acompanhamento de Pagamentos - RF Driver</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="css/css-theme.css">
</head>

<body>

<div class="drawer-toggle" onclick="GlobalUI.toggleDrawer()">
  <i class="fa fa-bars"></i>
</div>

<div class="theme-toggle" onclick="GlobalTheme.toggle()">
  <i class="fa fa-moon"></i>
</div>

<div id="menu-lateral"></div>

<main id="conteudo">

  <section class="card">
    <h1 style="color:var(--gold)">Acompanhamento de Pagamentos</h1>
    <p style="opacity:.7">Controle de despesas por vencimento</p>
  </section>

  <section class="card" id="listaPagamentos">
    <!-- ConteÃºdo dinÃ¢mico -->
  </section>

</main>

<div id="menu-inferior"></div>

<script src="js/js-dataManager.js"></script>
<script src="js/js-global.js"></script>
<script src="js/PlanoManager.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  GlobalUI.loadComponent("menu-lateral","components/components-menu-lateral.html");
  GlobalUI.loadComponent("menu-inferior","components/components-menu-inferior.html");

  // ðŸ”’ BLOQUEIO FREEMIUM
  if(PlanoManager.isBloqueado("financeiro")){
    PlanoManager.redirecionarUpgrade();
    return;
  }

  renderPagamentos();
});

function renderPagamentos(){
  const dados = DataManager.getData();
  const hoje = new Date().toISOString().slice(0,10);

  const lista = dados.pagamentos
    .filter(p => !p.pago)
    .sort((a,b) => a.dataVencimento.localeCompare(b.dataVencimento));

  if(!lista.length){
    listaPagamentos.innerHTML = "<p style='opacity:.6'>Nenhum pagamento pendente.</p>";
    return;
  }

  listaPagamentos.innerHTML = lista.map(p => `
    <div class="item-list">
      <strong>${p.descricao}</strong><br>
      <small>${p.categoria} â€¢ vence em ${p.dataVencimento}</small><br>
      <span>${Number(p.valor).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}</span>
    </div>
  `).join("");
}
</script>

</body>
</html>
