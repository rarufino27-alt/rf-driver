<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Resumo — RF Driver</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="css/css-theme.css">
</head>

<body>

<!-- TOGGLES -->
<div class="drawer-toggle" onclick="GlobalUI.toggleDrawer()">
  <i class="fa fa-bars"></i>
</div>

<div class="theme-toggle" onclick="GlobalTheme.toggle()">
  <i class="fa fa-moon"></i>
</div>

<!-- MENU LATERAL -->
<div id="menu-lateral"></div>

<!-- CONTEÚDO -->
<main id="conteudo">

  <!-- ===== HEADER ===== -->
  <section class="card hero-card">
    <h1 class="hero-title">Resumo financeiro</h1>
    <p class="hero-subtitle">
      Visão geral do seu desempenho
    </p>
  </section>

  <!-- ===== VISÃO GERAL ===== -->
  <section class="dashboard-grid">

    <div class="card entrada">
      <small>Total de entradas</small>
      <strong id="resEntradas">R$ 0,00</strong>
    </div>

    <div class="card saida">
      <small>Total de saídas</small>
      <strong id="resSaidas">R$ 0,00</strong>
    </div>

  </section>

  <!-- ===== SALDO FINAL ===== -->
  <section class="card" style="margin-top:16px;text-align:center">
    <small style="opacity:.7">Saldo final</small>
    <strong id="resSaldo"
            style="display:block;font-size:2rem;margin-top:6px;color:var(--gold)">
      R$ 0,00
    </strong>
  </section>

  <!-- ===== METAS ===== -->
  <section class="card" style="margin-top:16px">
    <strong>Meta diária</strong>

    <div class="progress-bar">
      <div class="progress-fill" id="metaResumo"></div>
    </div>

    <small id="metaResumoInfo" style="opacity:.7"></small>
  </section>

</main>

<!-- MENU INFERIOR -->
<div id="menu-inferior"></div>

<!-- SCRIPTS -->
<script src="js/js-global.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  GlobalUI.loadComponent(
    "menu-lateral",
    "components/components-menu-lateral.html"
  );

  GlobalUI.loadComponent(
    "menu-inferior",
    "components/components-menu-inferior.html"
  );

  const entradas = Number(localStorage.getItem("rf_caixa_total_entradas") || 0);
  const saidas   = Number(localStorage.getItem("rf_caixa_total_saidas") || 0);
  const saldo    = entradas - saidas;

  document.getElementById("resEntradas").innerText =
    entradas.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

  document.getElementById("resSaidas").innerText =
    saidas.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

  document.getElementById("resSaldo").innerText =
    saldo.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

  /* ===== META ===== */
  const meta = Number(localStorage.getItem("rf_meta_diaria") || 0);
  const metaResumo = document.getElementById("metaResumo");
  const metaResumoInfo = document.getElementById("metaResumoInfo");

  if(meta > 0){
    const perc = Math.min((entradas / meta) * 100, 100);
    metaResumo.style.width = perc + "%";
    metaResumoInfo.innerText =
      `${perc.toFixed(0)}% da meta diária atingida`;
  }else{
    metaResumo.style.width = "0%";
    metaResumoInfo.innerText =
      "Meta diária não definida";
  }

});
</script>

</body>
</html>