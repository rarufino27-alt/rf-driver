<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Registro de Despesas - RF Driver</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<link rel="stylesheet" href="css/css-theme.css">
</head>

<body>

<div class="drawer-toggle" onclick="GlobalUI.toggleDrawer()">
  <i class="fa fa-bars"></i>
</div>

<div class="theme-toggle" onclick="GlobalTheme.toggle()">
  <i class="fa fa-moon"></i>
</div>

<div id="menu-lateral"></div>

<main id="conteudo">

  <section class="card">
    <h1 style="color:var(--gold)">Registrar Despesa</h1>
    <p style="opacity:.7">Controle seus gastos com clareza</p>
  </section>

  <section class="card">

    <label>Categoria</label>
    <select id="categoria">
      <option>Alimenta√ß√£o</option>
      <option>Combust√≠vel</option>
      <option>Cart√£o</option>
      <option>Financiamento</option>
      <option>Aluguel</option>
      <option>IPVA</option>
      <option>Outros</option>
    </select>

    <label>Descri√ß√£o</label>
    <input id="descricao" placeholder="Ex: Cart√£o Nubank">

    <label>Tipo</label>
    <select id="tipo">
      <option value="despesa">Despesa</option>
      <option value="divida">D√≠vida</option>
    </select>

    <label>Valor</label>
    <input id="valor" type="number" step="0.01">

    <label>Data de vencimento</label>
    <input id="data" type="date">

    <button class="btn-primary" onclick="registrar()">Registrar</button>
  </section>

</main>

<div id="menu-inferior"></div>

<script src="js/js-dataManager.js"></script>
<script src="js/js-global.js"></script>
<script src="js/PlanoManager.js"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
  GlobalUI.loadComponent("menu-lateral","components/components-menu-lateral.html");
  GlobalUI.loadComponent("menu-inferior","components/components-menu-inferior.html");

  // üîí BLOQUEIO FREEMIUM
  if(PlanoManager.isBloqueado("despesas")){
    PlanoManager.redirecionarUpgrade();
  }
});

function registrar(){
  const categoria = categoriaEl.value;
  const descricao = descricaoEl.value.trim();
  const tipo = tipoEl.value;
  const valor = Number(valorEl.value);
  const dataBase = dataEl.value;

  if(!descricao || !valor || valor <= 0 || !dataBase){
    alert("Preencha todos os campos corretamente.");
    return;
  }

  const dados = DataManager.getData();

  dados.pagamentos.push({
    id: DataManager.gerarId(),
    tipo,
    categoria,
    descricao,
    valor,
    dataVencimento: dataBase,
    pago: false
  });

  DataManager.saveData(dados);

  alert("Despesa registrada com sucesso.");
  descricaoEl.value = "";
  valorEl.value = "";
  dataEl.value = "";
}

const categoriaEl = document.getElementById("categoria");
const descricaoEl = document.getElementById("descricao");
const tipoEl = document.getElementById("tipo");
const valorEl = document.getElementById("valor");
const dataEl = document.getElementById("data");
</script>

</body>
</html>
